<div class="row" bis_skin_checked="1">
  <div class="col-lg-12" bis_skin_checked="1">
    <div class="card" bis_skin_checked="1">
      <div class="card-body" bis_skin_checked="1">
        <a href="/product" class="btn btn-light waves-effect mb-4"><i class="uil-arrow-left"></i><span>Назад</span></a>
        <div class="row" bis_skin_checked="1">
          <div class="col-xl-5" bis_skin_checked="1">
            <div class="product-detail" bis_skin_checked="1">
              <div class="row" bis_skin_checked="1">
                <div class="col-4" bis_skin_checked="1" style="max-height: 600px; display: flex;">
                  <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical"
                  bis_skin_checked="1">
                    {{#each firstImages.img}}
                    <a class="nav-link active" id="product-1-tab" data-bs-toggle="pill" role="tab" style="margin-right: 15px;"
                      bis_size="{&quot;x&quot;:290,&quot;y&quot;:151,&quot;w&quot;:167,&quot;h&quot;:95,&quot;abs_x&quot;:290,&quot;abs_y&quot;:151}">
                        <img src="/{{@this}}" alt=""
                        class="img-fluid mx-auto d-block tab-img rounded"
                        bis_size="{&quot;x&quot;:333,&quot;y&quot;:159,&quot;w&quot;:80,&quot;h&quot;:80,&quot;abs_x&quot;:333,&quot;abs_y&quot;:159}"
                        bis_id="bn_3xwg67vnekpsdreja5qmep">
                      </a>
                    {{/each}}
                  </div>
                  {{!-- <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical"
                  bis_skin_checked="1">
                    {{#each secondImages.img}}
                    <a class="nav-link active" id="product-1-tab" data-bs-toggle="pill" role="tab" style="margin-right: 15px;"
                      bis_size="{&quot;x&quot;:290,&quot;y&quot;:151,&quot;w&quot;:167,&quot;h&quot;:95,&quot;abs_x&quot;:290,&quot;abs_y&quot;:151}">
                        <img src="/{{@this}}" alt=""
                        class="img-fluid mx-auto d-block tab-img rounded"
                        bis_size="{&quot;x&quot;:333,&quot;y&quot;:159,&quot;w&quot;:80,&quot;h&quot;:80,&quot;abs_x&quot;:333,&quot;abs_y&quot;:159}"
                        bis_id="bn_3xwg67vnekpsdreja5qmep">
                      </a>
                    {{/each}}
                  </div> --}}
                  {{!-- <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical"
                  bis_skin_checked="1">
                    {{#each thirdImages.img}}
                    <a class="nav-link active" id="product-1-tab" data-bs-toggle="pill" role="tab" style="margin-right: 15px;"
                      bis_size="{&quot;x&quot;:290,&quot;y&quot;:151,&quot;w&quot;:167,&quot;h&quot;:95,&quot;abs_x&quot;:290,&quot;abs_y&quot;:151}">
                        <img src="/{{@this}}" alt=""
                        class="img-fluid mx-auto d-block tab-img rounded"
                        bis_size="{&quot;x&quot;:333,&quot;y&quot;:159,&quot;w&quot;:80,&quot;h&quot;:80,&quot;abs_x&quot;:333,&quot;abs_y&quot;:159}"
                        bis_id="bn_3xwg67vnekpsdreja5qmep">
                      </a>
                    {{/each}}
                  </div> --}}
                </div>

                <div class="col-5" bis_skin_checked="1">
                  <div class="tab-content position-relative" id="v-pills-tabContent" bis_skin_checked="1">

                    <div class="tab-pane fade show active" id="product-1" role="tabpanel" bis_skin_checked="1">
                      <div class="product-img" bis_skin_checked="1" >
                        <img src="/{{mainImage}}" alt="" class="img-fluid mx-auto d-block" style="height: 100%;">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-7" bis_skin_checked="1">
            <div class="mt-5 mt-xl-3 ps-xl-4" bis_skin_checked="1">
              <h5 class="font-size-14"><a href="#" class="text-muted">Продукт:</a></h5>

              <div class="d-flex align-items-center mt-4">
                <h5 class="font-size-14">Наименование продукта: </h5>
                <h4 class="font-size-20" style="margin-left: 30px;">{{product.title}}</h4>
              </div>

              <div class="d-flex align-items-center mt-2" bis_skin_checked="1">
                <h5 class="font-size-14">Цена: </h5>
                <h4 class="font-size-20 " style="margin-left: 30px;">{{product.price}}</h4>
                <!-- <span class="font-size-16 me-2">book.author</span> -->
              </div>

              <div class="mt-2" bis_skin_checked="1">
                <h5 class="font-size-14">Краткое содержание/Описание:</h5>
                <h5 class="mt-1 text-muted">{{product.description}}</р>
                <!-- <span class="font-size-16 me-2">book.author</span> -->
              </div>


              <div bis_skin_checked="1">
                <div class="row" bis_skin_checked="1">
                  <div class="col-md-8" bis_skin_checked="1">
                    <div class="mt-3" bis_skin_checked="1">

                      <h5 class="font-size-14">Характеристики</h5>
                      <ul class="list-unstyled product-desc-list text-muted">
                        <li class=""><i class="mdi mdi-circle-medium me-1 align-middle">Категория: </i>{{product.category.title}}</li>
                        <li class=""><i class="mdi mdi-circle-medium me-1 align-middle">Субкатегория: </i>{{product.subcategory.title}}</li>
                        <li><i class="mdi mdi-circle-medium me-1 align-middle">Материал: </i>{{product.material}}</li>
                        <li class=""><i class="mdi mdi-circle-medium me-1 align-middle">Цвета: </i> 
                          {{#each product.details}}
                          <i class="mdi mdi-circle text-color mx-1" style="color: {{color}}"></i>
                          {{/each}}
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- end row -->
        <div class="table-responsive mt-4" bis_skin_checked="1">
          <table class="table table-editable table-nowrap align-middle table-edits">
            <thead>
              <tr style="cursor: pointer;">
                <th>№</th>
                <th>Цвета</th>
                <th>Фотографии</th>
                <th>Размеры</th>
                <th>Статус</th>
                <th>Изменить</th>
                <th>Удалить</th>
              </tr>
            </thead>
            <tbody>
              {{#each inside}}
              <tr data-id="1" style="cursor: pointer;">
                <td data-field="id" style="width: 80px">{{index}}</td>
                <td>
                  <div class="sp-colorize" style="background-color:{{color}};width:20px;height:20px;border-radius: 5px;" bis_skin_checked="1"></div>
                </td>
                <td>
                  {{#each img}}
                  <img src="/{{@this}}" style="height: 40px; padding-left: 5px;">
                  {{/each}}
                </td>
                <td>{{size}}</td>
                <td><span class="{{class}}">{{status}}</span></td>
                <td style="width: 100px;">
                  <button class="btn btn-outline-secondary" title="Изменить" type="button" data-bs-toggle="modal"
                    data-bs-target="#detailsModal" onclick="change('{{@root.product._id}}', '{{@index}}')">
                    <i class="fas fa-pencil-alt"></i>
                  </button>
                </td>
                <td style="width: 100px">
                  <a href="/product/details/delete/{{@root.product._id}}/{{@index}}" class="btn btn-outline-secondary" title="Удалить">
                    <i class="uil-trash-alt"></i>
                  </a>
                </td>
              </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
        {{!-- add details --}}
          <div class="modal fade bs-example-modal-xl" id="detailsModal" tabindex="-1"
            aria-labelledby="myExtraLargeModalLabel" bis_skin_checked="1" style="padding-right: 19px;" aria-modal="true"
            role="dialog">
            <div class="modal-dialog modal-xl" bis_skin_checked="1">
              <div class="modal-content" bis_skin_checked="1">
                <div class="modal-header" bis_skin_checked="1">
                  <h5 class="modal-title mt-0" id="myExtraLargeModalLabel">Добавать детали</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                  </button>
                </div>
                <div class="modal-body" bis_skin_checked="1">
                  <form action="/product/info/save/details" method="post" enctype="multipart/form-data" name="detail">
                    <input type="hidden" name="_id">
                    <input type="hidden" name="index">

                    <div class="row">
                      <div class="mb-3 col-lg-3" bis_skin_checked="1">
                        <label class="form-label" for="formrow-firstname-input">Цвет</label>
                        <input type="color" class="form-control" id="formrow-firstname-input" name="color">
                      </div>

                      <div class="col-lg-3 mb-3" bis_skin_checked="1">
                        <input type="file" class="form-control-file" name="img" style="margin-top: 30px;" multiple>
                      </div>

                      <div class="mb-3 col-lg-6" bis_skin_checked="1">
                        <label class="form-label" for="formrow-firstname-input">Размеры</label>
                        <input type="text" class="form-control" id="formrow-firstname-input" name="size" placeholder="Пишите S, XS, XXS, и т.д.">
                      </div>
                    </div>

                    <div class="form-check form-switch mb-3" dir="ltr" bis_skin_checked="1">
                      <input type="checkbox" class="form-check-input" id="customSwitch1" checked="" name="detailStatus"
                        value="1">
                      <label class="form-check-label" for="customSwitch1">Активность</label>
                    </div>

                    <div class="modal-footer" bis_skin_checked="1">
                      <button type="button" class="btn btn-light waves-effect" data-bs-dismiss="modal">Закрыть</button>
                      <button type="submit" class="btn btn-primary waves-effect waves-light">Добавить</button>
                    </div>
                  </form>
                </div>
              </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
          </div>
      </div>
    </div>
  </div>
</div>

<script>

  let detailsForm = document.forms.detail

  function change(id, index){
    fetch(`/product/details/${id}/${index}`)
    .then(res => res.json())
    .then(fIndex =>{
      detailsForm._id.value = id
      detailsForm.index.value = index
      detailsForm.color.value = fIndex.color
      detailsForm.size.value = fIndex.size
      detailsForm.detailStatus.checked = fIndex.detailStatus == 1 ? true : false
    })
  }
</script>